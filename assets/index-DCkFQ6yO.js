import{_ as b,r as i,o as _,c as w,g as o,w as n,e as h,q as d,t as y}from"./index-BfDU3yUm.js";const S={data(){return{pageSize:15,currPage:1,userNameForm:"",phoneForm:"",tableData:[]}},methods:{handleSizeChange(t){this.pageSize=t,this.schoolAdminSelect()},handleCurrentChange(t){this.currPage=t,this.schoolAdminSelect()},select(){this.schoolAdminSelect()},async schoolDelete(t){try{await this.$confirm(`确定删除${t.account||""}?`,"信息",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const e=await this.$http({url:this.$http.adornUrl("admin/school/deleteAdminSchool"),method:"delete",params:this.$http.adornParams({userId:t.userId})});if(e.data.code===500)throw new Error(e.data.msg);this.$message({message:"删除成功",type:"success",duration:1500}),this.schoolAdminSelect()}catch(e){if(e.name==="DialogCancelledError")return;console.error("删除操作失败:",e.message||"error"),this.$message.error("删除操作失败:",e.message||"error")}},async schoolAdminSelect(){try{this.tableDataLoading=!0;const t=await this.$http({url:this.$http.adornUrl("admin/school/pageAdminSchool"),method:"get",params:this.$http.adornParams({page:this.currPage,limit:this.pageSize,userName:this.userNameForm,phone:this.phoneForm})});if(t.data.code==500)throw new Error(t.data.msg);{let e=t.data;e.data.records.forEach(r=>{Array.isArray(r.region)&&(r.region=r.region.join(" | "))}),this.tableData=e.data,this.tableDataLoading=!1}}catch(t){console.error("请求数据失败:",t.message),this.tableDataLoading=!1,this.$message.error(t.message||"加载数据失败，请检查网络或稍后重试")}}},mounted(){this.schoolAdminSelect()},beforeRouteEnter(t,e,r){r(m=>{m.schoolAdminSelect()})},beforeRouteUpdate(t,e,r){this.schoolAdminSelect(),r()}},C={style:{display:"flex","justify-content":"start","margin-top":"10px"}},A={"slot-scope":"scope"},z={"slot-scope":"scope"},v={style:{"text-align":"center","margin-top":"10px"}};function x(t,e,r,m,s,p){const c=i("el-button"),u=i("el-input"),a=i("el-table-column"),g=i("el-table"),f=i("el-pagination");return _(),w("div",null,[o(c,{type:"primary",icon:"el-icon-circle-plus-outline",onClick:e[0]||(e[0]=l=>t.$router.push("/schoolAdd"))},{default:n(()=>[d("添加管理员")]),_:1}),h("div",C,[o(u,{modelValue:s.userNameForm,"onUpdate:modelValue":e[1]||(e[1]=l=>s.userNameForm=l),placeholder:"账号",class:"input"},null,8,["modelValue"]),o(u,{modelValue:s.phoneForm,"onUpdate:modelValue":e[2]||(e[2]=l=>s.phoneForm=l),placeholder:"手机号码",class:"input"},null,8,["modelValue"]),o(c,{type:"primary",icon:"el-icon-search",onClick:e[3]||(e[3]=l=>p.schoolAdminSelect())},{default:n(()=>[d("查询")]),_:1})]),o(g,{data:s.tableData.records,height:"calc(100vh - 300px)",class:"table",border:"","header-cell-style":{background:"#e6e6e6"}},{default:n(()=>[o(a,{fixed:"left",prop:"userId",label:"ID",width:"100"}),o(a,{label:"账号",prop:"userName",width:"150"}),o(a,{label:"所属角色",prop:"roleName",width:"150"}),o(a,{label:"邮箱",prop:"email",width:"190"}),o(a,{label:"手机号",prop:"mobile",width:"150"}),o(a,{label:"所属区域",prop:"region","show-overflow-tooltip":"",width:"200"}),o(a,{label:"创建时间",prop:"createTime",width:"190"}),o(a,{fixed:"right",label:"状态",prop:"status",width:"100"},{default:n(()=>[h("template",A,[d(y(t.scope.row.status==1?"正常":"禁用"),1)])]),_:1}),o(a,{fixed:"right",label:"操作",width:"200"},{default:n(()=>[h("template",z,[o(c,{size:"mini",type:"primary",onClick:e[4]||(e[4]=l=>t.$router.push(`/schoolAmend?userId=${t.scope.row.userId}`))},{default:n(()=>[d("编辑 ")]),_:1}),o(c,{size:"mini",type:"danger",onClick:e[5]||(e[5]=l=>p.schoolDelete(t.scope.row))},{default:n(()=>[d(" 删除 ")]),_:1})])]),_:1})]),_:1},8,["data"]),h("div",v,[o(f,{onSizeChange:p.handleSizeChange,onCurrentChange:p.handleCurrentChange,"page-sizes":[15,30,50,75,100],"page-size":s.pageSize,"current-page":s.currPage,layout:"total,sizes, prev, pager, next,jumper",total:s.tableData.total},null,8,["onSizeChange","onCurrentChange","page-size","current-page","total"])])])}const N=b(S,[["render",x],["__scopeId","data-v-6029a3d6"]]);export{N as default};
